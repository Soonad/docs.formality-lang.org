

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>11. Undefined behavior &mdash; Formality-Core 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="10. Loops and Recursion" href="Loops-and-Recursion.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Formality-Core
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Why-Formality-Core?.html">1. Why Formality-Core?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hello,-world!.html">3. Hello, World!</a></li>
<li class="toctree-l1"><a class="reference internal" href="Numbers-and-Operators.html">4. Numbers and Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pairs.html">5. Pairs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lets-and-Defs.html">6. Lets and Defs</a></li>
<li class="toctree-l1"><a class="reference internal" href="If-and-Cpy.html">7. If and Cpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dups-and-Boxes.html">8. Dups and Boxes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lambdas-and-Affinity.html">9. Lambdas and Affinity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Loops-and-Recursion.html">10. Loops and Recursion</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">11. Undefined behavior</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Formality-Core</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>11. Undefined behavior</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/language/Undefined-Behavior.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="undefined-behavior">
<h1>11. Undefined behavior<a class="headerlink" href="#undefined-behavior" title="Permalink to this headline">¶</a></h1>
<p>In languages like C, indexing an array outside of its bounds is <a class="reference external" href="https://en.wikipedia.org/wiki/Undefined_behavior">undefined behavior</a>, i.e., once you do it, you can’t assume anything about the behavior or output of your program. Since Formality-Core doesn’t have a type system, it has a set of situations for which the behavior is undefined. In some cases, your program may output an expected result even after encountering an undefined behavior, but that can’t be relied on. It is the programmer’s responsibility to make sure that no undefined behavior happens.</p>
<p>Any interaction between primitives that was not explicitly defined should be considered undefined behavior. For example, <code class="docutils literal notranslate"><span class="pre">|&quot;foo&quot;</span> <span class="pre">+</span> <span class="pre">3|</span></code>, i.e., attempting to add a string and a number, is undefined behavior because there is no reduction rule covering that case. If you run it with the interpreter, it will warn you with a message error. If you run it with interaction nets, anything can happen. For this reason, it’s always good to develop and debug with the interpreter.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cpy</span></code> primitive, in particular, is worth noting. If you try to copy a lambda with <code class="docutils literal notranslate"><span class="pre">cpy</span></code>, the interpreter will warn you with a runtime error message, but, if you try to evaluate it with interaction nets, it will actually output the “expected” result in many cases. For example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">def</span> <span class="nx">main</span><span class="o">:</span>
  <span class="nx">cpy</span> <span class="nx">f</span> <span class="o">=</span> <span class="p">{</span><span class="nx">x</span><span class="p">}</span><span class="nx">x</span>
  <span class="nx">f</span>
</pre></div>
</div>
<p>Will output <code class="docutils literal notranslate"><span class="pre">[{x}x,</span> <span class="pre">{x}x]</span></code> if evaluated with interaction nets. This doesn’t mean you can use <code class="docutils literal notranslate"><span class="pre">cpy</span></code> to copy anything other than native numbers. Here, for example, is a very problematic term:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">def</span> <span class="nx">main</span><span class="o">:</span>
  <span class="nx">cpy</span> <span class="nx">square</span> <span class="o">=</span> <span class="p">{</span><span class="nx">x</span><span class="p">}</span> 
    <span class="nx">cpy</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span>
    <span class="o">|</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span><span class="o">|</span>
  <span class="p">[(</span><span class="nx">square</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="nx">square</span> <span class="mi">3</span><span class="p">)]</span>
</pre></div>
</div>
<p>If you try to evaluate it with interaction nets, it will output <code class="docutils literal notranslate"><span class="pre">[6,6]</span></code>, which is not the “expected” result! The technical reason is that this program has two duplication nodes of identical labels pointing to themselves. They interfere destructively, getting the interaction net system into a corrupt state which may behave unpredictably.</p>
<p>Similar situations can happen when trying to duplicate a term that isn’t inside a box. Boxes are fully erased after compilation, so, interaction nets won’t display a nice error message in those cases. Instead, they will go ahead copying the unboxed lambda, and anything can happen afterward. Be very cautious with copies and always use the interpreter to make sure you’re not trying to copy an unboxed value!</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="Loops-and-Recursion.html" class="btn btn-neutral float-left" title="10. Loops and Recursion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Sunshine Cybernetics

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>